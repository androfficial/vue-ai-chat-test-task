# Internationalization

This document explains the internationalization (i18n) system.

## Overview

The application uses **Vue I18n** for internationalization with support for English and Ukrainian. Translation files are located in `src/locales/`.

## Supported Languages

- **English (en)** - Default language
- **Ukrainian (uk)** - Secondary language

## Translation Structure

### File Organization

```
src/locales/
├── index.ts    # i18n configuration
├── en.ts       # English translations
└── uk.ts       # Ukrainian translations
```

### Translation File Format

```typescript
// src/locales/en.ts
export default {
  common: {
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
  },
  chat: {
    new: 'New Chat',
    placeholder: 'Type a message...',
    send: 'Send',
  },
  settings: {
    title: 'Settings',
    api: {
      title: 'API Settings',
      apiKey: 'API Key',
    },
  },
}
```

## Usage

### In Templates

Use `$t()` function:

```vue
<template>
  <h1>{{ $t('settings.title') }}</h1>
  <v-btn>{{ $t('common.save') }}</v-btn>
</template>
```

### In Script

Use `useI18n()` composable:

```typescript
import { useI18n } from 'vue-i18n'

const { t, locale } = useI18n()

const title = t('settings.title')

function changeLanguage(lang: 'en' | 'uk') {
  locale.value = lang
}
```

## Translation Patterns

### Simple Translation

```typescript
// Translation
common: {
  save: 'Save',
}

// Usage
$t('common.save')
```

### Nested Keys

```typescript
// Translation
settings: {
  api: {
    title: 'API Settings',
  },
}

// Usage
$t('settings.api.title')
```

### With Parameters

```typescript
// Translation
chat: {
  messageCount: 'You have {count} messages',
}

// Usage
$t('chat.messageCount', { count: 5 })
// Result: "You have 5 messages"
```

### Pluralization

```typescript
// Translation
chat: {
  messageCount: 'no messages | 1 message | {count} messages',
}

// Usage
$t('chat.messageCount', { count: 0 })  // "no messages"
$t('chat.messageCount', { count: 1 })   // "1 message"
$t('chat.messageCount', { count: 5 })   // "5 messages"
```

## i18n Configuration

### Setup

**Location**: `src/plugins/i18n.ts`

```typescript
import { createI18n } from 'vue-i18n'

import en from '@/locales/en'
import uk from '@/locales/uk'

export default createI18n({
  legacy: false,
  locale: 'en',
  fallbackLocale: 'en',
  messages: {
    en,
    uk,
  },
})
```

### Type Safety

TypeScript types are automatically inferred from the English translation file:

```typescript
// types/index.ts
import type en from '@/locales/en'

declare module 'vue-i18n' {
  export interface DefineLocaleMessage {
    typeof en
  }
}
```

## Language Switching

### Programmatic Switching

```typescript
import { useI18n } from 'vue-i18n'

const { locale } = useI18n()

function changeLanguage(lang: 'en' | 'uk') {
  locale.value = lang
  // Optionally save to localStorage
  localStorage.setItem('preferred-language', lang)
}
```

### Persistence

Language preference is stored in the user store and persisted to localStorage.

## Adding Translations

### Step 1: Add to English File

```typescript
// src/locales/en.ts
export default {
  myFeature: {
    title: 'My Feature',
    description: 'This is my new feature',
  },
}
```

### Step 2: Add to Ukrainian File

```typescript
// src/locales/uk.ts
export default {
  myFeature: {
    title: 'Моя функція',
    description: 'Це моя нова функція',
  },
}
```

### Step 3: Use in Component

```vue
<template>
  <h1>{{ $t('myFeature.title') }}</h1>
  <p>{{ $t('myFeature.description') }}</p>
</template>
```

## Translation Organization

### Recommended Structure

```typescript
{
  // Common UI elements
  common: {
    save: 'Save',
    cancel: 'Cancel',
    // ...
  },

  // Feature-specific
  chat: {
    new: 'New Chat',
    // ...
  },
  settings: {
    title: 'Settings',
    // ...
  },

  // Error messages
  errors: {
    networkError: 'Network error',
    // ...
  },

  // Validation messages
  validation: {
    required: 'This field is required',
    // ...
  },
}
```

## Best Practices

### ✅ DO

- Keep keys organized (nested structure)
- Use descriptive keys
- Keep translations synchronized
- Use parameters for dynamic content
- Test both languages
- Add JSDoc comments for complex translations

### ❌ DON'T

- Hardcode text
- Skip translations
- Use generic keys
- Mix languages in one file
- Forget to update all language files

## Adding a New Language

### Step 1: Create Translation File

```bash
touch src/locales/de.ts
```

### Step 2: Copy Structure

Copy English file structure and translate:

```typescript
// src/locales/de.ts
export default {
  common: {
    save: 'Speichern',
    cancel: 'Abbrechen',
    // ... translate all keys
  },
}
```

### Step 3: Register Language

Update `src/locales/index.ts`:

```typescript
import de from './de'
import en from './en'
import uk from './uk'

export default createI18n({
  // ...
  messages: {
    de,
    en,
    uk,
  },
})
```

### Step 4: Update Types

Add language to type definitions if needed.

## Testing Translations

### Manual Testing

1. Switch language in Settings
2. Navigate through application
3. Verify all text is translated
4. Check for missing keys

### Automated Testing

```typescript
import { describe, expect, it } from 'vitest'
import en from '@/locales/en'
import uk from '@/locales/uk'

describe('Translations', () => {
  it('should have same keys in all languages', () => {
    const enKeys = getKeys(en)
    const ukKeys = getKeys(uk)
    expect(enKeys).toEqual(ukKeys)
  })
})

function getKeys(obj: Record<string, any>, prefix = ''): string[] {
  const keys: string[] = []
  for (const key in obj) {
    const fullKey = prefix ? `${prefix}.${key}` : key
    if (typeof obj[key] === 'object') {
      keys.push(...getKeys(obj[key], fullKey))
    } else {
      keys.push(fullKey)
    }
  }
  return keys
}
```

## Common Translation Keys

Reference for common translations:

```typescript
{
  common: {
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    edit: 'Edit',
    close: 'Close',
    confirm: 'Confirm',
    loading: 'Loading...',
    error: 'Error',
    success: 'Success',
  },
  errors: {
    networkError: 'Network error. Check your connection.',
    unauthorized: 'Invalid API key.',
    rateLimited: 'Rate limit exceeded.',
    serverError: 'Server error. Please try again.',
    unknown: 'An unknown error occurred.',
  },
}
```

## Next Steps

- Review [Adding Translations Guide](../how-to/add-translations.md)
- Study [Development Patterns](./patterns.md)
- Check [Components Reference](../reference/components.md)

---

**Internationalization explained!** This system provides flexible, type-safe translations.
